@model List<ScoringRole>
@{
    Layout = "_AdminLayout";
    ViewBag.Title = "Scoring Roles";
    var scoringRoles = Model;
    Dictionary<string, ScoreQuestion> scoringQuestions = ViewBag.ScoringQuestions;
}

<style>
    .role-name {
        font-size: large;
    }
    .role-description {
        font-size: small;
    }
    .question-title {
        font-size: large;
    }
    .question-description {
        font-size: small;
    }
</style>

<h1 class="text-white">@ViewBag.Title</h1>

@foreach (var group in scoringRoles.GroupBy(p=> p.ScoringGroup).OrderByDescending(g=> g.Average(p=>p.ScoringWeight)))
{
    double avgRoleWeight = Math.Round(group.ToList().Average(p=> p.ScoringWeight),2);

    <h3 class="text-white">@group.Key <span style="font-size:small;">(Avg. Weight: @avgRoleWeight)</span></h3>
    <table class="table table-sm table-bordered table-bordered text-white" style="background-color:var(--bh-dark-green-gray);">
        <tr>
            <th>Role</th>
            <th>Questions</th>
        </tr>
        @foreach (ScoringRole scoringRole in group)
        {   
            <tr>
                <td>
                    <div class="role-name">@scoringRole.Name</div>
                    <div class="role-description">@scoringRole.Description</div>
                    <div class="role-description" style="margin-top:10px;">Weight: @scoringRole.ScoringWeight</div>
                </td>
                <td>
                    @foreach (string scoreQuestionId in scoringRole.ScoreQuestionsIds)
                    {
                        var scoreQuestion = scoringQuestions[scoreQuestionId];
                        <div class="question-title">@scoreQuestion.Title</div>
                        <div class="question-description">@scoreQuestion.Description</div>
                    }
                </td>
                <td>
                    <a class="btn btn-sm btn-primary" style="margin-bottom:5px;" asp-action="UpdateScoringRole" asp-route-id="@scoringRole.Id">Update</a>
                    <form asp-action="DeleteScoringRole" asp-route-id="@scoringRole.Id" method="post"><button type="submit" class="btn btn-sm btn-danger">Delete</button></form>
                </td>
            </tr>
        }
    </table>
}
<a asp-action="CreateScoringRole" class="btn btn-secondary" style="margin: 0 0 50px 0;">Add a Role</a>


